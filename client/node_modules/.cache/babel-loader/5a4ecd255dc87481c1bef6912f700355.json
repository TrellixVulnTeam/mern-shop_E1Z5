{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\grunge\\\\Desktop\\\\mycms\\\\frontend\\\\src\\\\pages\\\\OrderPage.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Row, Col, NavLink, ListGroup, Image, Card } from 'react-bootstrap';\nimport { PayPalButton } from \"react-paypal-button-v2\";\nimport { Link } from 'react-router-dom';\nimport { getOrderDetails, payOrder } from '../actions/orderAction';\nimport { ORDER_PAY_RESET } from '../constants/orderConstant';\nimport { useDispatch, useSelector } from 'react-redux';\nimport axios from 'axios';\nimport Loading from '../components/Loading';\nimport Message from '../components/Message';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst OrderPage = ({\n  match,\n  history\n}) => {\n  _s();\n\n  const orderId = match.params.id;\n  const [sdkReady, setSdkReady] = useState(false);\n  const dispatch = useDispatch();\n  const orderDetails = useSelector(state => state.orderDetails);\n  const {\n    order,\n    loading,\n    error\n  } = orderDetails;\n  const orderPay = useSelector(state => state.orderPay);\n  const {\n    success: successPay,\n    loading: loadingPay\n  } = orderPay; //const orderDeliver = useSelector((state) => state.orderDeliver);\n  //const { success: successDeliver, loading: loadingDeliver } = orderDeliver;\n\n  const userLogin = useSelector(state => state.userLogin);\n  const {\n    userInfo\n  } = userLogin;\n\n  if (!loading && order) {\n    const addDecimals = num => {\n      return (Math.round(num * 100) / 100).toFixed(2);\n    };\n\n    order.itemsPrice = addDecimals(order.orderItems.reduce((acc, item) => acc + item.price * item.qty, 0));\n  }\n\n  useEffect(() => {\n    if (!userInfo) {\n      history.push('/login');\n    }\n\n    const addPaypalScript = async () => {\n      const {\n        data: clientId\n      } = await axios.get('/api/config/paypal');\n      const script = document.createElement('script');\n      script.type = 'text/javascript';\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}`;\n      script.async = true;\n\n      script.onload = () => {\n        setSdkReady(true);\n      };\n\n      document.body.appendChild(script);\n    };\n\n    if (!order || order._id !== orderId) {\n      dispatch({\n        type: ORDER_PAY_RESET\n      }); //dispatch({ type: ORDER_DELIVER_RESET });\n\n      dispatch(getOrderDetails(orderId));\n    } else if (!order.isPaid) {\n      if (!window.paypal) {\n        addPaypalScript();\n      } else {\n        setSdkReady(true);\n      }\n    }\n  }, [dispatch, order, orderId, successPay, history]);\n  return loading ? /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 21\n  }, this) : error ? /*#__PURE__*/_jsxDEV(Message, {\n    variant: \"danger\",\n    message: error\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 12\n  }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: [\"Order: \", order._id]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 11\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        md: 8,\n        children: [/*#__PURE__*/_jsxDEV(ListGroup, {\n          variant: \"flush\",\n          children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"Shipping\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 79,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: order.user.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 80,\n                columnNumber: 32\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: order.user.email\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 81,\n                columnNumber: 32\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 81,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Adress: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 82,\n                columnNumber: 32\n              }, this), order.shippingAdress.adress, \", \", order.shippingAdress.city, \",  \", order.shippingAdress.postalcode, \",  \", order.shippingAdress.country]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 82,\n              columnNumber: 29\n            }, this), order.isDelivered ? /*#__PURE__*/_jsxDEV(Message, {\n              variant: \"success\",\n              message: order.paidAt\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 84,\n              columnNumber: 50\n            }, this) : /*#__PURE__*/_jsxDEV(Message, {\n              variant: \"danger\",\n              message: \"Not Delivered\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 84,\n              columnNumber: 108\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"Payment Method\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 87,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: order.paymentMethod\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 88,\n                columnNumber: 32\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 88,\n              columnNumber: 29\n            }, this), order.isPaid ? /*#__PURE__*/_jsxDEV(Message, {\n              variant: \"success\",\n              message: order.paidAt\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 89,\n              columnNumber: 45\n            }, this) : /*#__PURE__*/_jsxDEV(Message, {\n              variant: \"danger\",\n              message: \"Not Paid\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 89,\n              columnNumber: 103\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(ListGroup, {\n          variant: \"flush\",\n          children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n            children: /*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"Order Items\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 93,\n              columnNumber: 41\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 25\n          }, this), order.orderItems.length === 0 ? /*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"your Order list is empty!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 27\n          }, this) : /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n            children: order.orderItems.map((item, index) => /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: /*#__PURE__*/_jsxDEV(Row, {\n                children: [/*#__PURE__*/_jsxDEV(Col, {\n                  md: 1,\n                  children: /*#__PURE__*/_jsxDEV(Image, {\n                    src: item.image,\n                    alt: item.title,\n                    fluid: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 101,\n                    columnNumber: 39\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 100,\n                  columnNumber: 35\n                }, this), /*#__PURE__*/_jsxDEV(Col, {\n                  children: /*#__PURE__*/_jsxDEV(NavLink, {\n                    as: Link,\n                    to: `/products/product/${item.product}`,\n                    children: item.title\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 104,\n                    columnNumber: 37\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 103,\n                  columnNumber: 35\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 99,\n                columnNumber: 31\n              }, this)\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 27\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 27\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        md: 4,\n        children: [/*#__PURE__*/_jsxDEV(Card, {\n          children: /*#__PURE__*/_jsxDEV(ListGroup, {\n            variant: \"flush\",\n            children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: /*#__PURE__*/_jsxDEV(\"h2\", {\n                children: \"Order Summary\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 117,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(Row, {\n                children: [/*#__PURE__*/_jsxDEV(Col, {\n                  children: \"Items\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 121,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Col, {\n                  children: [\"$ \", order.itemPrice]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 122,\n                  columnNumber: 33\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 120,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(Row, {\n                children: [/*#__PURE__*/_jsxDEV(Col, {\n                  children: \"Shipping\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 125,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Col, {\n                  children: [\"$ \", order.shippingPrice]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 126,\n                  columnNumber: 33\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 124,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(Row, {\n                children: [/*#__PURE__*/_jsxDEV(Col, {\n                  children: \"Tax\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 129,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Col, {\n                  children: [\"$ \", order.taxPrice]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 130,\n                  columnNumber: 33\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 128,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(Row, {\n                children: [/*#__PURE__*/_jsxDEV(Col, {\n                  children: \"Total\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 133,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Col, {\n                  children: [\"$ \", order.totalPrice]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 134,\n                  columnNumber: 33\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 132,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 119,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: error && /*#__PURE__*/_jsxDEV(Message, {\n                variant: \"danger\",\n                message: error\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 139,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 138,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 15\n        }, this), !order.isPaid && /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n          children: [loadingPay && /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 40\n          }, this), !sdkReady ? /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 39\n          }, this) : /*#__PURE__*/_jsxDEV(PayPalButton, {\n            amount: order.totalPrice,\n            onSuccess: handlePaymentSuccess\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 52\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 39\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 15\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 11\n    }, this)]\n  }, void 0, true);\n};\n\n_s(OrderPage, \"rrbNON/UYIqXGkQYibYFMzN82yw=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector];\n});\n\n_c = OrderPage;\nexport default OrderPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"OrderPage\");","map":{"version":3,"sources":["C:/Users/grunge/Desktop/mycms/frontend/src/pages/OrderPage.jsx"],"names":["React","useEffect","useState","Row","Col","NavLink","ListGroup","Image","Card","PayPalButton","Link","getOrderDetails","payOrder","ORDER_PAY_RESET","useDispatch","useSelector","axios","Loading","Message","OrderPage","match","history","orderId","params","id","sdkReady","setSdkReady","dispatch","orderDetails","state","order","loading","error","orderPay","success","successPay","loadingPay","userLogin","userInfo","addDecimals","num","Math","round","toFixed","itemsPrice","orderItems","reduce","acc","item","price","qty","push","addPaypalScript","data","clientId","get","script","document","createElement","type","src","async","onload","body","appendChild","_id","isPaid","window","paypal","user","name","email","shippingAdress","adress","city","postalcode","country","isDelivered","paidAt","paymentMethod","length","map","index","image","title","product","itemPrice","shippingPrice","taxPrice","totalPrice","handlePaymentSuccess"],"mappings":"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","sourcesContent":["import React,{useEffect, useState} from 'react'\r\nimport {Row, Col, NavLink, ListGroup, Image, Card} from 'react-bootstrap'\r\nimport { PayPalButton } from \"react-paypal-button-v2\"\r\nimport {Link} from 'react-router-dom'\r\nimport { getOrderDetails, payOrder } from '../actions/orderAction'\r\nimport {ORDER_PAY_RESET} from '../constants/orderConstant'\r\nimport {useDispatch,useSelector} from 'react-redux'\r\nimport axios from 'axios'\r\nimport Loading from '../components/Loading'\r\nimport Message from '../components/Message'\r\n\r\n\r\nconst OrderPage = ({match,history}) => {\r\n    \r\n  const orderId = match.params.id;\r\n\r\n  const [sdkReady, setSdkReady] = useState(false);\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  const orderDetails = useSelector((state) => state.orderDetails);\r\n  const { order, loading, error } = orderDetails;\r\n\r\n  const orderPay = useSelector((state) => state.orderPay);\r\n  const { success: successPay, loading: loadingPay } = orderPay;\r\n\r\n  //const orderDeliver = useSelector((state) => state.orderDeliver);\r\n  //const { success: successDeliver, loading: loadingDeliver } = orderDeliver;\r\n\r\n  const userLogin = useSelector((state) => state.userLogin);\r\n  const { userInfo} = userLogin;\r\n\r\n  if (!loading && order) {\r\n    const addDecimals = (num) => {\r\n      return (Math.round(num * 100) / 100).toFixed(2);\r\n    };\r\n\r\n    order.itemsPrice = addDecimals(\r\n      order.orderItems.reduce((acc, item) => acc + item.price * item.qty, 0)\r\n    );\r\n  }\r\n\r\n  useEffect(() => {\r\n    if(!userInfo){\r\n      history.push('/login')\r\n    }\r\n    const addPaypalScript = async () => {\r\n      const { data: clientId } = await axios.get('/api/config/paypal');\r\n      const script = document.createElement('script');\r\n      script.type = 'text/javascript';\r\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}`;\r\n      script.async = true;\r\n      script.onload = () => {\r\n        setSdkReady(true);\r\n      };\r\n      document.body.appendChild(script);\r\n    };\r\n\r\n    if (!order || order._id !== orderId ) {\r\n      dispatch({ type: ORDER_PAY_RESET });\r\n      //dispatch({ type: ORDER_DELIVER_RESET });\r\n      dispatch(getOrderDetails(orderId));\r\n    } else if (!order.isPaid) {\r\n      if (!window.paypal) {\r\n        addPaypalScript();\r\n      } else {\r\n        setSdkReady(true);\r\n      }\r\n    }\r\n  }, [dispatch, order, orderId, successPay, history]);\r\n    return loading? <Loading/> \r\n    :error?<Message variant=\"danger\" message={error} />: (\r\n        <>\r\n          <h2>Order: {order._id}</h2>  \r\n          <Row>\r\n              <Col md={8}>\r\n              <ListGroup variant=\"flush\">\r\n                    <ListGroup.Item>\r\n                        <h2>Shipping</h2> \r\n                            <p><strong>{order.user.name}</strong></p> \r\n                            <p><strong>{order.user.email}</strong></p>                        \r\n                            <p><strong>Adress: </strong>\r\n                            {order.shippingAdress.adress}, {order.shippingAdress.city},  {order.shippingAdress.postalcode},  {order.shippingAdress.country}</p>\r\n                            {order.isDelivered? (<Message variant=\"success\" message={order.paidAt} />) : ( <Message variant=\"danger\" message=\"Not Delivered\" /> )}\r\n                    </ListGroup.Item>            \r\n                    <ListGroup.Item>\r\n                        <h2>Payment Method</h2>\r\n                            <p><strong>{order.paymentMethod}</strong></p>\r\n                            {order.isPaid? (<Message variant=\"success\" message={order.paidAt} />) : ( <Message variant=\"danger\" message=\"Not Paid\" /> )}\r\n                    </ListGroup.Item>\r\n                </ListGroup>\r\n                    <ListGroup variant=\"flush\">\r\n                        <ListGroup.Item><h2>Order Items</h2></ListGroup.Item>\r\n                         {order.orderItems.length===0 \r\n                        ?(<h3>your Order list is empty!</h3>)\r\n                        :(<ListGroup.Item>\r\n                            {order.orderItems.map((item,index)=>(\r\n                          <ListGroup.Item key={index}>\r\n                              <Row>\r\n                                  <Col md={1}>\r\n                                      <Image src={item.image} alt={item.title} fluid/>\r\n                                  </Col>\r\n                                  <Col>\r\n                                    <NavLink as={Link} to={`/products/product/${item.product}`}>{item.title}</NavLink>\r\n                                  </Col>                                 \r\n                                </Row>\r\n                            </ListGroup.Item>  \r\n                        ))}\r\n                        </ListGroup.Item>)}\r\n                        \r\n                    </ListGroup>\r\n              </Col>\r\n              <Col md={4}>\r\n              <Card>\r\n                    <ListGroup variant=\"flush\">\r\n                        <ListGroup.Item>\r\n                            <h2>Order Summary</h2>\r\n                        </ListGroup.Item>\r\n                        <ListGroup.Item>\r\n                            <Row>\r\n                                <Col>Items</Col>\r\n                                <Col>$ {order.itemPrice}</Col>\r\n                            </Row>\r\n                            <Row>\r\n                                <Col>Shipping</Col>\r\n                                <Col>$ {order.shippingPrice}</Col>\r\n                            </Row>\r\n                            <Row>\r\n                                <Col>Tax</Col>\r\n                                <Col>$ {order.taxPrice}</Col>\r\n                            </Row>\r\n                            <Row>\r\n                                <Col>Total</Col>\r\n                                <Col>$ {order.totalPrice}</Col>\r\n                                \r\n                            </Row>\r\n                        </ListGroup.Item>\r\n                        <ListGroup.Item>\r\n                        {error&&<Message variant=\"danger\" message={error}/>}\r\n                        </ListGroup.Item>                        \r\n                    </ListGroup>\r\n                    </Card>\r\n                    {/* <ListGroup.Item>\r\n                    <PayPalButton \r\n                        amount={order.totalPrice}\r\n                        onSuccess={handlePaymentSuccess}\r\n                        />\r\n                    </ListGroup.Item> */}\r\n                \r\n                    {!order.isPaid&& (<ListGroup.Item>\r\n                        {loadingPay && <Loading/>}\r\n                        {!sdkReady ? (<Loading/>):(<PayPalButton \r\n                        amount={order.totalPrice}\r\n                        onSuccess={handlePaymentSuccess}\r\n                        />) }\r\n                    </ListGroup.Item> \r\n                         )}\r\n                    \r\n                </Col>\r\n          </Row>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default OrderPage\r\n"]},"metadata":{},"sourceType":"module"}